<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
	<meta id="viewport" name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
	<meta name="apple-mobile-web-app-capable" content="yes">

	<title>Using peoteSocketBridge.swf wrapper from javascript</title>
	
	<script src="swfobject-2.3.js" type="text/javascript"></script>
	<script src="PeoteBytesInput.js" type="text/javascript"></script>
	<script src="PeoteBytesOutput.js" type="text/javascript"></script>
	
	<script>
		// starter here -> peoteSocketBridge.swf raw socket wrapper is available
		function PeoteSocketBridge() {
			console.log("swf bridge available");
			
			// DO it in Javascript to use RAW socket ofer swf-bridge
			var peoteSocket = new PeoteSocket({
				onConnect: function(connected, msg) {
					console.log("onConnect:"+connected+" - "+msg);
					//var output = new PeoteBytesOutput();
					//output.writeByte(255);
					//output.writeUInt16(65535);
					//output.writeInt16(32767);
					//output.writeInt16(-32768);
					//output.writeInt32(2147483647);
					//output.writeInt32(-2147483648);
					//output.writeFloat(1.2345678);
					//output.writeDouble(1.2345678901234567890123456789);
					//output.writeString("Hello Server");
					//peoteSocket.send(output.getBytes());
				},
				onClose: function(msg) {
					console.log("onClose:"+msg);
				},
				onError: function(msg) {
					console.log("onError:"+msg);
				},
				onData: function(peoteBytes) {
					console.log("onData:");
					var input = new PeoteBytesInput(peoteBytes);
					console.log( "data bytes length = " + input.length);
					while (input.position < input.length)
					{
						console.log(input.position + ":" + input.readByte());
					}
					//console.log(input.readByte());
					//console.log(input.readUInt16());
					//console.log(input.readInt16());
					//console.log(input.readInt32());
					//console.log(input.readFloat());
					//console.log(input.readDouble());
					//console.log(input.readString());

				}
			});
			
			peoteSocket.connect("192.168.1.50", 23);
		}

		
		// ---------------------------------------------------------------
		// swfobject for raw socket wrapper through flashplayerwormhole ;)
		// ---------------------------------------------------------------
		var flashvars = {
		};
		var params = {
			menu: "false",
			scale: "noScale",
			allowScriptAccess: "always",
			allowNetworking: "true",
			bgcolor: "#000000"
		};
		var attributes = {
			id:"PeoteSocketBridge"
		};
		swfobject.embedSWF("peoteSocketBridge.swf", "PeoteSocketBridgeWrapper", "1", "1", "11.0.0", "expressInstall.swf", flashvars, params, attributes);
		console.log("swf embedded");
	</script>
	
	<style>
		html,body { margin: 0; padding: 0; height: 100%; overflow: hidden; }
		#content { background: #000000; width: 100%; height: 100%; }
	</style>
</head>

<body>
	<div id="PeoteSocketBridgeWrapper">
		<p>flash-wrapper could not loaded (to get raw sockets in webbrowser in 2014)</p>
		<p><a href="http://www.adobe.com/go/getflashplayer">
		      <img src="http://www.adobe.com/images/shared/download_buttons/get_flash_player.gif" alt="Get Adobe Flash player" />
		   </a>
		</p>
	</div>
</body>
</html>